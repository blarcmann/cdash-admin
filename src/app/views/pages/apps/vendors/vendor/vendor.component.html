<kt-portlet>
	<kt-portlet-header [title]="pageTitle" [class]="'kt-portlet__head--lg'" [viewLoading$]="loading$">
		<ng-container ktPortletTools>
			<div class="details-action edit text-center" routerLink="/strada/vendors/manage/{{ vendorId }}">
				<img src="./assets/media/icons/details-edit.svg" alt="">
				<span>Edit</span>
			</div>
			<div class="details-action delete text-center" (click)="onDelete()">
				<img src="./assets/media/icons/details-delete.svg" alt="">
				<span>Delete</span>
			</div>
		</ng-container>
	</kt-portlet-header>
	<kt-portlet-body>
		<div class="goback" (click)="goBack()">
			<img src="./assets/media/icons/backBtn.svg" alt="">
			<span>Back</span>
		</div>
		<div class="contact-body" *ngIf="vendorDetails">
			<div class="item-details maxed pt-0">
				<div class="row">
					<div class="col-lg-6">
						<table class="ml-5 details-table">
							<tr class="each-data">
								<td class="label">Name</td>
								<td class="value">{{ vendorDetails.name }}</td>
							</tr>
							<tr class="each-data">
								<td class="label">Industry</td>
								<td class="value">{{ vendorDetails.industry }}</td>
							</tr>
							<tr class="each-data">
								<td class="label">Email</td>
								<td class="value">
									<a href="mailto:{{ vendorDetails.email }}">{{vendorDetails.email}}</a>
								</td>
							</tr>
							<tr class="each-data">
								<td class="label">Phone</td>
								<td class="value">{{ vendorDetails.phone }}</td>
							</tr>
							<tr class="each-data">
								<td class="label">Address</td>
								<td class="value">{{ vendorDetails.address }}</td>
							</tr>
							<tr class="each-data">
								<td class="label">Address</td>
								<td class="value">{{ vendorDetails.goods }}</td>
							</tr>
							<tr class="each-data">
								<td class="label">Created On</td>
								<td class="value">
									{{ vendorDetails.created_at | date: "medium" }}
								</td>
							</tr>
							<tr class="each-data">
								<td class="label">Updated On</td>
								<td class="value">
									{{ vendorDetails.updated_at | date: "medium" }}
								</td>
							</tr>
							<tr class="each-data">
								<td class="label">Goods</td>
								<td class="value lighter">
									<div class="goods">
										<div class="good" *ngFor="let good of vendorDetails.goods; let i = index;">
											{{ good | titlecase }}
										</div>
									</div>
								</td>
							</tr>
						</table>
					</div>
					<div class="col-lg-6">
						<div class="side-form">
							<div class="form-types">
								<div [className]="activeTab === 'po' ? 'type-menu active' : 'type-menu'"
									(click)="activateTab('po')">Purchase order</div>
								<div [className]="activeTab === 'goods' ? 'type-menu active' : 'type-menu'"
									(click)="activateTab('goods')">Vendor goods</div>
							</div>
							<div class="users-cover" *ngIf="activeTab === 'goods'">
								<!-- <div class="mt-4"> -->
								<form>
									<div class="row">
										<div class="col-lg-12">
											<div class="form-item">
												<label class="label"> Quantity</label>
												<input type="text" placeholder="Quantity is required"
													[(ngModel)]="good">
											</div>
										</div>
									</div>
									<!-- <div class="navigation">
											<button class="action primary" (click)="showPage2()">Next page</button>
										</div> -->
									<div class="navigation">
										<button class="action primary comment" (click)="addVendorGood()">Add vendor
											good</button>
									</div>
								</form>
								<!-- </div> -->
								<div class="users-list mt-4" *ngIf="vendorDetails && goods.length > 0">
									<div class="each-user" *ngFor="let good of goods; let i = index">
										<div class="name">
											<img src="./assets/media/icons/details-icon.svg" alt="">
											{{good | titlecase}}
										</div>
										<div class="action ml-4" (click)="removeGood(i)">
											<img src="./assets/media/icons/delete-close.svg" alt="">
										</div>
									</div>
								</div>
							</div>
							<div class="users-cover" *ngIf="activeTab === 'po'">
								<form [formGroup]="addGoodForm" class="slide-in">
									<div class="row">
										<div class="col-lg-12">
											<div class="form-item">
												<label class="label">Goods</label>
												<select formControlName="good" class="mt-1">
													<option value="">Select good</option>
													<option value="{{good}}" *ngFor="let good of POgoods;">{{good}}
													</option>
												</select>
											</div>
										</div>
									</div>
									<div class="mt-2 navigation">
										<button class="action primary comment" (click)="addSelectedGood()">Add
											good</button>
									</div>
								</form>
								<div class="mt-1">
									<div class="col-md-12 slide-in mt-3 mb-5" *ngIf="showAmountQuantity">
										<form [formGroup]="goodForm">
											<div class="row">
												<div class="col-lg-12">
													<div class="form-item">
														<label class="label"> Quantity</label>
														<input type="number" placeholder="Quantity is required"
															formControlName="quantity">
													</div>
												</div>
											</div>
											<div class="row">
												<div class="col-lg-12">
													<div class="form-item">
														<label class="label"> Amount</label>
														<input type="number" placeholder="Amount required"
															formControlName="amount">
													</div>
												</div>
											</div>
											<button mat-raised-button [disabled]="!goodForm.valid"
												(click)="pushGoodValues()">Add Good To PO</button>
										</form>
									</div>
								</div>
								<div *ngIf="goods && payloadGoods.length > 0" class="mt-2">Goods Added</div>
								<div class="users-list mt-3" *ngIf="goods && payloadGoods.length > 0">
									<div class="each-user" *ngFor="let good of payloadGoods; let i = index;">
										<div class="name">
											<img src="./assets/media/icons/details-icon.svg" alt="">
											{{good | titlecase}}
										</div>
										<div class="action ml-4" (click)="removePayGood(i)">
											<img src="./assets/media/icons/delete-close.svg" alt="">
										</div>
									</div>
								</div>
								<form [formGroup]="poform">
									<div class="row">
										<div class="col-lg-12">
											<div class="form-item">
												<label class="label"> Subject</label>
												<input type="text" placeholder="Quantity is required"
													formControlName="subject">
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-12">
											<div class="form-item">
												<label class="label"> Body</label>
												<input type="text" placeholder="Quantity is required"
													formControlName="body">
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-12">
											<div class="form-item">
												<label class="label"> Shipping Address</label>
												<input type="text" placeholder="Quantity is required"
													formControlName="shipping">
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-12">
											<div class="form-item">
												<label class="label">Projects</label>
												<select formControlName="project_id">
													<option value="">Select project</option>
													<option value="{{project._id}}" *ngFor="let project of projects;">
														{{project.name}}
													</option>
												</select>
											</div>
										</div>
									</div>
									<div class="navigation mt-4">
										<button class="action primary comment" (click)="sendPO()">Send PO</button>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div *ngIf="!vendorDetails" class="mt-5 please-data text-center">Please retry...</div>
		</div>
		<!-- <div class="title mt-5">Purchase order list</div> -->
		<table class="table-view mt-5">
			<thead>
				<tr>
					<th>Purchase Id</th>
					<th>Subject</th>
					<th>Body</th>
					<th>Shipping address</th>
				</tr>
			</thead>
			<tbody>
				<tr className="each-row" *ngFor="let po of poList">
					<td>{{ po.purchase_id }}</td>
					<td>{{ po.subject }}</td>
					<td>{{ (po.body.length > 33) ? (po.body | slice:0:33)+'...' : (po.body)}}
					</td>
					<td>{{ po.address ? po.address : 'not available'}}</td>
				</tr>
			</tbody>
		</table>
		<div class="empty-list text-center" *ngIf=" poList && poList.length === 0">
			<img src="./assets/media/icons/empty-list.png" alt="">
			<p>No POs have been sent yet.</p>
		</div>
	</kt-portlet-body>
</kt-portlet>
